<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Programmatic API - Tabs Examples</title>
    <script type="module" src="../src/tabs.js"></script>
    <link rel="stylesheet" href="../src/styles.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <nav class="examples-nav">
      <a href="index.html" class="nav-logo">Tabs Examples</a>
      <div class="nav-links">
        <a href="index.html">Home</a>
        <a href="basic.html">Basic</a>
        <a href="navigation.html">Navigation</a>
        <a href="keyboard-events.html">Keyboard</a>
        <a href="styling.html">Styling</a>
        <a href="animations.html">Animations</a>
        <a href="edge-cases.html">Edge Cases</a>
        <a href="api.html" class="active">API</a>
        <a href="advanced.html">Advanced</a>
      </div>
    </nav>

    <div class="container">
      <header>
        <h1>Programmatic API</h1>
        <p class="header-subtitle">
          Control tabs with JavaScript: goTo(), next(), prev(), refresh(),
          destroy(), and URL sync
        </p>
      </header>

      <section class="test-category">
        <div class="test-case" data-test-id="20">
          <div class="test-header">
            <span class="test-number">20</span>
            <h3>API Methods Demo</h3>
          </div>
          <div class="test-content">
            <p class="test-description">
              Demonstrates programmatic control: goTo(), next(), prev(),
              refresh(), and destroy() methods.
            </p>
            <div class="tabs-demo">
              <div data-tabs="container" id="test20-tabs" class="sliding-pill">
                <div class="tabs-trigger-list" role="tablist">
                  <button class="tabs-trigger" data-tabs-trigger-id="api-1">
                    API 1
                  </button>
                  <button class="tabs-trigger" data-tabs-trigger-id="api-2">
                    API 2
                  </button>
                  <button class="tabs-trigger" data-tabs-trigger-id="api-3">
                    API 3
                  </button>
                  <button class="tabs-trigger" data-tabs-trigger-id="api-4">
                    API 4
                  </button>
                  <button class="tabs-trigger" data-tabs-trigger-id="api-5">
                    API 5
                  </button>
                </div>
                <div class="tabs-panels">
                  <div class="tabs-panel" data-tabs-panel-id="api-1">
                    Panel 1 - Use buttons below to control tabs
                    programmatically.
                  </div>
                  <div class="tabs-panel" data-tabs-panel-id="api-2">
                    Panel 2 - goTo(), next(), and prev() methods available.
                  </div>
                  <div class="tabs-panel" data-tabs-panel-id="api-3">
                    Panel 3 - refresh() re-initializes after DOM changes.
                  </div>
                  <div class="tabs-panel" data-tabs-panel-id="api-4">
                    Panel 4 - destroy() cleans up all event listeners.
                  </div>
                  <div class="tabs-panel" data-tabs-panel-id="api-5">
                    Panel 5 - getActiveValue() returns current active value.
                  </div>
                </div>
              </div>
              <div class="api-controls">
                <button id="api-prev">prev()</button>
                <button id="api-next">next()</button>
                <button id="api-goto1">goTo('api-1')</button>
                <button id="api-goto3">goTo('api-3')</button>
                <button id="api-goto5">goTo('api-5')</button>
                <button id="api-refresh">refresh()</button>
                <button id="api-destroy" class="danger">destroy()</button>
                <button id="api-reinit">Re-init</button>
              </div>
              <div class="event-log" id="test20-log">
                API calls will be logged here...
              </div>
            </div>
          </div>
        </div>

        <div class="test-case" data-test-id="21">
          <div class="test-header">
            <span class="test-number">21</span>
            <h3>URL Sync (Group Name)</h3>
          </div>
          <div class="test-content">
            <p class="test-description">
              Tabs sync with URL parameters. Change tabs and see the URL update.
              Reload the page to restore state.
            </p>
            <div class="tabs-demo">
              <div
                data-tabs="container"
                data-tabs-group-name="section"
                id="test21-tabs"
                class="sliding-pill"
              >
                <div class="tabs-trigger-list" role="tablist">
                  <button class="tabs-trigger" data-tabs-trigger-id="intro">
                    Introduction
                  </button>
                  <button class="tabs-trigger" data-tabs-trigger-id="setup">
                    Setup
                  </button>
                  <button class="tabs-trigger" data-tabs-trigger-id="usage">
                    Usage
                  </button>
                  <button class="tabs-trigger" data-tabs-trigger-id="api">
                    API Reference
                  </button>
                </div>
                <div class="tabs-panels">
                  <div class="tabs-panel" data-tabs-panel-id="intro">
                    <strong>Introduction</strong> - Welcome to the
                    documentation. The URL now shows ?section=intro
                  </div>
                  <div class="tabs-panel" data-tabs-panel-id="setup">
                    <strong>Setup</strong> - Installation instructions here. The
                    URL now shows ?section=setup
                  </div>
                  <div class="tabs-panel" data-tabs-panel-id="usage">
                    <strong>Usage</strong> - How to use the library. The URL now
                    shows ?section=usage
                  </div>
                  <div class="tabs-panel" data-tabs-panel-id="api">
                    <strong>API Reference</strong> - Complete API documentation.
                    The URL now shows ?section=api
                  </div>
                </div>
              </div>
            </div>
            <dl class="info-panel" id="test21-info">
              <div class="info-item">
                <dt>Group Name</dt>
                <dd>section</dd>
              </div>
              <div class="info-item">
                <dt>Current URL Param</dt>
                <dd id="test21-url-param">-</dd>
              </div>
              <div class="info-item">
                <dt>Active Value</dt>
                <dd id="test21-active">-</dd>
              </div>
            </dl>
            <div class="code-block">
              data-tabs-group-name="section" syncs with ?section=value in the
              URL. Share URLs to link directly to specific tabs.
            </div>
          </div>
        </div>
      </section>
    </div>

    <script type="module">
      import { waitForTabs } from './shared.js';

      // Test 20: API controls
      waitForTabs(() => {
        const tabs = window.Tabs.get('#test20-tabs');
        const log = document.getElementById('test20-log');
        const events = [];

        const logEvent = (msg) => {
          events.unshift(`${new Date().toLocaleTimeString()}: ${msg}`);
          if (log) log.textContent = events.slice(0, 10).join('\n');
        };

        if (tabs) {
          document.getElementById('api-prev')?.addEventListener('click', () => {
            tabs.prev();
            logEvent(`prev() -> active: "${tabs.getActiveValue()}"`);
          });

          document.getElementById('api-next')?.addEventListener('click', () => {
            tabs.next();
            logEvent(`next() -> active: "${tabs.getActiveValue()}"`);
          });

          document
            .getElementById('api-goto1')
            ?.addEventListener('click', () => {
              tabs.goTo('api-1');
              logEvent(`goTo('api-1') -> active: "${tabs.getActiveValue()}"`);
            });

          document
            .getElementById('api-goto3')
            ?.addEventListener('click', () => {
              tabs.goTo('api-3');
              logEvent(`goTo('api-3') -> active: "${tabs.getActiveValue()}"`);
            });

          document
            .getElementById('api-goto5')
            ?.addEventListener('click', () => {
              tabs.goTo('api-5');
              logEvent(`goTo('api-5') -> active: "${tabs.getActiveValue()}"`);
            });

          document
            .getElementById('api-refresh')
            ?.addEventListener('click', () => {
              tabs.refresh();
              logEvent('refresh() -> instance re-initialized');
            });

          document
            .getElementById('api-destroy')
            ?.addEventListener('click', () => {
              tabs.destroy();
              logEvent('destroy() -> instance destroyed, clicks disabled');
            });

          document
            .getElementById('api-reinit')
            ?.addEventListener('click', () => {
              const container = document.getElementById('test20-tabs');
              window.Tabs.init(container);
              logEvent('Tabs.init() -> new instance created');
            });
        }
      });

      // Test 21: URL sync info panel
      waitForTabs(() => {
        const tabs = window.Tabs.get('#test21-tabs');
        const urlParamEl = document.getElementById('test21-url-param');
        const activeEl = document.getElementById('test21-active');

        if (tabs && tabs.config.groupName === 'section') {
          const updateInfo = () => {
            const params = new URLSearchParams(window.location.search);
            if (urlParamEl)
              urlParamEl.textContent = params.get('section') || '(none)';
            if (activeEl) activeEl.textContent = tabs.state.activeValue || '-';
          };

          tabs.on('change', updateInfo);
          updateInfo();
        }
      });
    </script>
  </body>
</html>
