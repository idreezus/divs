<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Marquee Library Test Suite</title>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/gsap.min.js"></script>
  <script type="module" src="../../dist/marquee/latest/marquee.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
      background: #fafafa;
      color: #171717;
      line-height: 1.6;
      padding: 24px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      margin-bottom: 48px;
      padding-bottom: 24px;
      border-bottom: 1px solid #e5e5e5;
    }

    h1 {
      font-size: 32px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #171717;
    }

    .header-subtitle {
      color: #737373;
      font-size: 14px;
      margin-bottom: 16px;
    }

    .stats {
      display: flex;
      gap: 24px;
      font-size: 14px;
      font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
    }

    .stats span {
      padding: 4px 12px;
      background: #f5f5f5;
      border-radius: 6px;
      color: #737373;
    }

    .stats .pass { color: #16a34a; background: #f0fdf4; }
    .stats .fail { color: #dc2626; background: #fef2f2; }

    .test-category {
      margin-bottom: 48px;
    }

    .test-category > h2 {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 24px;
      color: #171717;
    }

    .test-case {
      background: #ffffff;
      border: 1px solid #e5e5e5;
      border-radius: 8px;
      margin-bottom: 16px;
      overflow: hidden;
    }

    .test-header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 20px;
      border-bottom: 1px solid #f5f5f5;
    }

    .test-number {
      font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
      font-size: 12px;
      color: #a3a3a3;
      font-weight: 600;
    }

    .test-header h3 {
      flex: 1;
      font-size: 16px;
      font-weight: 500;
      color: #171717;
    }

    .test-status {
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 4px;
      font-weight: 500;
      font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
    }

    .test-status.pending { background: #f5f5f5; color: #a3a3a3; }
    .test-status.pass { background: #f0fdf4; color: #16a34a; }
    .test-status.fail { background: #fef2f2; color: #dc2626; }

    .test-content {
      padding: 20px;
    }

    .marquee-container {
      display: flex;
      overflow: hidden;
      gap: 20px;
      border: 1px solid #e5e5e5;
      border-radius: 6px;
      padding: 20px;
      background: #fafafa;
    }

    .marquee-container.vertical {
      height: 300px;
      flex-direction: column;
    }

    .marquee-item {
      flex-shrink: 0;
      padding: 16px 24px;
      background: #ffffff;
      border: 1px solid #e5e5e5;
      border-radius: 6px;
      font-size: 14px;
      color: #171717;
    }

    .test-controls {
      padding: 0 20px 20px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    button {
      padding: 8px 16px;
      background: #ffffff;
      border: 1px solid #e5e5e5;
      border-radius: 6px;
      font-size: 14px;
      color: #171717;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.15s;
    }

    button:hover {
      background: #f5f5f5;
      border-color: #d4d4d4;
    }

    button:active {
      background: #e5e5e5;
    }

    button.primary {
      background: #171717;
      color: #ffffff;
      border-color: #171717;
    }

    button.primary:hover {
      background: #404040;
      border-color: #404040;
    }

    .test-result {
      display: none;
      padding: 16px 20px;
      background: #f5f5f5;
      border-top: 1px solid #e5e5e5;
      font-size: 13px;
      font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
    }

    .test-result.visible { display: block; }
    .test-result.pass { background: #f0fdf4; color: #16a34a; }
    .test-result.fail { background: #fef2f2; color: #dc2626; }

    .test-description {
      color: #737373;
      font-size: 13px;
      margin-bottom: 12px;
    }

    .code-block {
      background: #f5f5f5;
      padding: 12px;
      border-radius: 4px;
      font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
      font-size: 12px;
      margin-top: 12px;
      color: #525252;
      overflow-x: auto;
    }

    @media (max-width: 768px) {
      body { padding: 16px; }
      h1 { font-size: 24px; }
      .stats { flex-wrap: wrap; gap: 12px; }
      .test-header { flex-wrap: wrap; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Marquee Library Test Suite</h1>
      <p class="header-subtitle">Comprehensive testing for all features and edge cases</p>
      <div class="stats">
        <span id="pass-count">0 passed</span>
        <span id="fail-count">0 failed</span>
        <span id="pending-count">20 pending</span>
      </div>
    </header>

    <!-- Category 1: Basic Functionality -->
    <section class="test-category">
      <h2>Basic Functionality</h2>

      <div class="test-case" data-test-id="1">
        <div class="test-header">
          <span class="test-number">01</span>
          <h3>Basic Horizontal Marquee</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests default horizontal marquee with 5 items</p>
          <div class="marquee-container" data-marquee="true">
            <div data-marquee-item="true" class="marquee-item">Item 1</div>
            <div data-marquee-item="true" class="marquee-item">Item 2</div>
            <div data-marquee-item="true" class="marquee-item">Item 3</div>
            <div data-marquee-item="true" class="marquee-item">Item 4</div>
            <div data-marquee-item="true" class="marquee-item">Item 5</div>
          </div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="2">
        <div class="test-header">
          <span class="test-number">02</span>
          <h3>Basic Vertical Marquee</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests vertical marquee with flex-direction: column</p>
          <div class="marquee-container vertical" data-marquee="true">
            <div data-marquee-item="true" class="marquee-item">Item A</div>
            <div data-marquee-item="true" class="marquee-item">Item B</div>
            <div data-marquee-item="true" class="marquee-item">Item C</div>
            <div data-marquee-item="true" class="marquee-item">Item D</div>
            <div data-marquee-item="true" class="marquee-item">Item E</div>
          </div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="3">
        <div class="test-header">
          <span class="test-number">03</span>
          <h3>Reverse Direction</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests data-marquee-reverse="true" attribute</p>
          <div class="marquee-container" data-marquee="true" data-marquee-reverse="true">
            <div data-marquee-item="true" class="marquee-item">← Right</div>
            <div data-marquee-item="true" class="marquee-item">← to</div>
            <div data-marquee-item="true" class="marquee-item">← Left</div>
            <div data-marquee-item="true" class="marquee-item">← Movement</div>
          </div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="4">
        <div class="test-header">
          <span class="test-number">04</span>
          <h3>Custom Speed</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests data-marquee-speed="2" (2x faster)</p>
          <div class="marquee-container" data-marquee="true" data-marquee-speed="2">
            <div data-marquee-item="true" class="marquee-item">Fast 1</div>
            <div data-marquee-item="true" class="marquee-item">Fast 2</div>
            <div data-marquee-item="true" class="marquee-item">Fast 3</div>
            <div data-marquee-item="true" class="marquee-item">Fast 4</div>
          </div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>
    </section>

    <!-- Category 2: Smart Cloning -->
    <section class="test-category">
      <h2>Smart Cloning</h2>

      <div class="test-case" data-test-id="5">
        <div class="test-header">
          <span class="test-number">05</span>
          <h3>Few Large Items (Auto-clone)</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">2 large items should trigger higher clone count. Check console with ?marquee-debug</p>
          <div class="marquee-container" data-marquee="true">
            <div data-marquee-item="true" class="marquee-item" style="width: 300px;">Large Item 1</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 300px;">Large Item 2</div>
          </div>
          <div class="code-block">Expected: Clone count 4-5 (logged in console with ?marquee-debug)</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="6">
        <div class="test-header">
          <span class="test-number">06</span>
          <h3>Many Small Items (Auto-clone)</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">10 small items should trigger optimized clone count (varies by screen width)</p>
          <div class="marquee-container" data-marquee="true">
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">1</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">2</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">3</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">4</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">5</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">6</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">7</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">8</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">9</div>
            <div data-marquee-item="true" class="marquee-item" style="width: 50px;">10</div>
          </div>
          <div class="code-block">Expected: Lower clone count than large items (responsive to screen width)</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="7">
        <div class="test-header">
          <span class="test-number">07</span>
          <h3>Manual Clone Override</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests data-marquee-clone-count="3" override</p>
          <div class="marquee-container" data-marquee="true" data-marquee-clone-count="3">
            <div data-marquee-item="true" class="marquee-item">Manual 1</div>
            <div data-marquee-item="true" class="marquee-item">Manual 2</div>
            <div data-marquee-item="true" class="marquee-item">Manual 3</div>
          </div>
          <div class="code-block">Expected: Exactly 3 clone sets (9 items total)</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>
    </section>

    <!-- Category 3: Direction Detection -->
    <section class="test-category">
      <h2>Direction Detection</h2>

      <div class="test-case" data-test-id="8">
        <div class="test-header">
          <span class="test-number">08</span>
          <h3>Direction Change via Button</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Toggle flex-direction and verify automatic rebuild</p>
          <div class="marquee-container" data-marquee="true" id="test8-marquee">
            <div data-marquee-item="true" class="marquee-item">Toggle 1</div>
            <div data-marquee-item="true" class="marquee-item">Toggle 2</div>
            <div data-marquee-item="true" class="marquee-item">Toggle 3</div>
            <div data-marquee-item="true" class="marquee-item">Toggle 4</div>
          </div>
        </div>
        <div class="test-controls">
          <button id="toggle-direction">Toggle Direction</button>
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="9">
        <div class="test-header">
          <span class="test-number">09</span>
          <h3>Manual Refresh API</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Change direction manually and call window.Marquee.refresh()</p>
          <div class="marquee-container" data-marquee="true" id="test9-marquee">
            <div data-marquee-item="true" class="marquee-item">Refresh 1</div>
            <div data-marquee-item="true" class="marquee-item">Refresh 2</div>
            <div data-marquee-item="true" class="marquee-item">Refresh 3</div>
          </div>
        </div>
        <div class="test-controls">
          <button id="manual-toggle">Change Direction</button>
          <button id="manual-refresh">Call refresh()</button>
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="10">
        <div class="test-header">
          <span class="test-number">10</span>
          <h3>CSS Reverse Warning</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests console warning for row-reverse. Check console.</p>
          <div class="marquee-container" data-marquee="true" style="flex-direction: row-reverse;">
            <div data-marquee-item="true" class="marquee-item">Warning 1</div>
            <div data-marquee-item="true" class="marquee-item">Warning 2</div>
            <div data-marquee-item="true" class="marquee-item">Warning 3</div>
          </div>
          <div class="code-block">Expected: Console warning about using data-marquee-reverse instead</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>
    </section>

    <!-- Category 4: New API Methods -->
    <section class="test-category">
      <h2>New API Methods</h2>

      <div class="test-case" data-test-id="11">
        <div class="test-header">
          <span class="test-number">11</span>
          <h3>pauseAll / playAll</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Control multiple marquees with .test-group class</p>
          <div class="marquee-container test-group" data-marquee="true">
            <div data-marquee-item="true" class="marquee-item">Group A1</div>
            <div data-marquee-item="true" class="marquee-item">Group A2</div>
          </div>
          <div class="marquee-container test-group" data-marquee="true" style="margin-top: 12px;">
            <div data-marquee-item="true" class="marquee-item">Group B1</div>
            <div data-marquee-item="true" class="marquee-item">Group B2</div>
          </div>
          <div class="marquee-container test-group" data-marquee="true" style="margin-top: 12px;">
            <div data-marquee-item="true" class="marquee-item">Group C1</div>
            <div data-marquee-item="true" class="marquee-item">Group C2</div>
          </div>
        </div>
        <div class="test-controls">
          <button id="pause-all">Pause All</button>
          <button id="play-all">Play All</button>
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="12">
        <div class="test-header">
          <span class="test-number">12</span>
          <h3>getAll / has</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests window.Marquee.getAll() and window.Marquee.has()</p>
          <div class="marquee-container api-test" data-marquee="true" id="test12-marquee">
            <div data-marquee-item="true" class="marquee-item">API Test 1</div>
            <div data-marquee-item="true" class="marquee-item">API Test 2</div>
          </div>
          <div class="code-block" id="test12-output">Click "Run Test" to see API results</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="13">
        <div class="test-header">
          <span class="test-number">13</span>
          <h3>refreshAll</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Toggle all directions and call refreshAll()</p>
          <div class="marquee-container refresh-test" data-marquee="true">
            <div data-marquee-item="true" class="marquee-item">Refresh A1</div>
            <div data-marquee-item="true" class="marquee-item">Refresh A2</div>
          </div>
          <div class="marquee-container refresh-test" data-marquee="true" style="margin-top: 12px;">
            <div data-marquee-item="true" class="marquee-item">Refresh B1</div>
            <div data-marquee-item="true" class="marquee-item">Refresh B2</div>
          </div>
        </div>
        <div class="test-controls">
          <button id="toggle-all">Toggle All Directions</button>
          <button id="refresh-all">Call refreshAll()</button>
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="14">
        <div class="test-header">
          <span class="test-number">14</span>
          <h3>API Chaining</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests chainable API: pauseAll().playAll()</p>
          <div class="marquee-container chain-test" data-marquee="true">
            <div data-marquee-item="true" class="marquee-item">Chain 1</div>
            <div data-marquee-item="true" class="marquee-item">Chain 2</div>
          </div>
          <div class="code-block">window.Marquee.pauseAll().playAll('.chain-test')</div>
        </div>
        <div class="test-controls">
          <button id="test-chain">Test Chaining</button>
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>
    </section>

    <!-- Category 5: Repeat Count -->
    <section class="test-category">
      <h2>Repeat Count</h2>

      <div class="test-case" data-test-id="15">
        <div class="test-header">
          <span class="test-number">15</span>
          <h3>Play Once (repeat=0)</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests data-marquee-repeat="0" - should play once and stop</p>
          <div class="marquee-container" data-marquee="true" data-marquee-repeat="0" data-marquee-speed="3">
            <div data-marquee-item="true" class="marquee-item">Once 1</div>
            <div data-marquee-item="true" class="marquee-item">Once 2</div>
            <div data-marquee-item="true" class="marquee-item">Once 3</div>
          </div>
          <div class="code-block">Watch animation - should complete one loop and stop</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="16">
        <div class="test-header">
          <span class="test-number">16</span>
          <h3>Loop 3 Times (repeat=3)</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests data-marquee-repeat="3" - should loop 3 times</p>
          <div class="marquee-container" data-marquee="true" data-marquee-repeat="3" data-marquee-speed="3">
            <div data-marquee-item="true" class="marquee-item">3x Loop 1</div>
            <div data-marquee-item="true" class="marquee-item">3x Loop 2</div>
            <div data-marquee-item="true" class="marquee-item">3x Loop 3</div>
          </div>
          <div class="code-block">Watch animation - should complete 3 loops and stop</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>
    </section>

    <!-- Category 6: Error Handling -->
    <section class="test-category">
      <h2>Error Handling & Validation</h2>

      <div class="test-case" data-test-id="17">
        <div class="test-header">
          <span class="test-number">17</span>
          <h3>Missing Items Warning</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Container with no items should show helpful warning</p>
          <div class="marquee-container" data-marquee="true" id="empty-marquee">
            <!-- No items here -->
          </div>
          <div class="code-block">Expected: Console warning with example markup</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="18">
        <div class="test-header">
          <span class="test-number">18</span>
          <h3>CSS Validation Warnings</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Container with missing CSS should show warnings</p>
          <div data-marquee="true" id="invalid-css-marquee" style="display: block;">
            <div data-marquee-item="true" class="marquee-item">CSS Test 1</div>
            <div data-marquee-item="true" class="marquee-item">CSS Test 2</div>
          </div>
          <div class="code-block">Expected: Warnings for missing display:flex and overflow:hidden</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>

      <div class="test-case" data-test-id="19">
        <div class="test-header">
          <span class="test-number">19</span>
          <h3>Clone Count Cap</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Tests data-marquee-clone-count="999" - should cap at 10</p>
          <div class="marquee-container" data-marquee="true" data-marquee-clone-count="999">
            <div data-marquee-item="true" class="marquee-item">Cap Test 1</div>
            <div data-marquee-item="true" class="marquee-item">Cap Test 2</div>
          </div>
          <div class="code-block">Expected: Console warning and capped at 10 clones</div>
        </div>
        <div class="test-controls">
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>
    </section>

    <!-- Category 7: Edge Cases -->
    <section class="test-category">
      <h2>Edge Cases</h2>

      <div class="test-case" data-test-id="20">
        <div class="test-header">
          <span class="test-number">20</span>
          <h3>Hover + Direction Change</h3>
          <span class="test-status pending">Pending</span>
        </div>
        <div class="test-content">
          <p class="test-description">Hover effect should work after direction change</p>
          <div class="marquee-container" data-marquee="true" data-marquee-hover-effect="pause" id="test20-marquee">
            <div data-marquee-item="true" class="marquee-item">Hover 1</div>
            <div data-marquee-item="true" class="marquee-item">Hover 2</div>
            <div data-marquee-item="true" class="marquee-item">Hover 3</div>
          </div>
          <div class="code-block">1. Hover to pause 2. Toggle direction 3. Hover again - should still work</div>
        </div>
        <div class="test-controls">
          <button id="toggle-hover-direction">Toggle Direction</button>
          <button class="run-test primary">Run Test</button>
        </div>
        <div class="test-result"></div>
      </div>
    </section>
  </div>

  <script type="module">
    // Test state
    const testState = {
      passed: 0,
      failed: 0,
      pending: 20
    };

    function updateStats() {
      document.getElementById('pass-count').textContent = `${testState.passed} passed`;
      document.getElementById('fail-count').textContent = `${testState.failed} failed`;
      document.getElementById('pending-count').textContent = `${testState.pending} pending`;

      if (testState.passed > 0) document.getElementById('pass-count').classList.add('pass');
      if (testState.failed > 0) document.getElementById('fail-count').classList.add('fail');
    }

    function markTest(testId, status, message) {
      const testCase = document.querySelector(`[data-test-id="${testId}"]`);
      const statusEl = testCase.querySelector('.test-status');
      const resultEl = testCase.querySelector('.test-result');

      statusEl.className = `test-status ${status}`;
      statusEl.textContent = status === 'pass' ? 'Pass' : status === 'fail' ? 'Fail' : 'Pending';

      resultEl.className = `test-result visible ${status}`;
      resultEl.textContent = message;

      if (status === 'pass') {
        testState.passed++;
        testState.pending--;
      } else if (status === 'fail') {
        testState.failed++;
        testState.pending--;
      }

      updateStats();
    }

    // Test runners
    function runTest1() {
      const container = document.querySelector('[data-test-id="1"] .marquee-container');
      const instance = window.Marquee.get(container);

      if (instance && instance.timeline) {
        markTest(1, 'pass', '✓ Marquee initialized and animating');
      } else {
        markTest(1, 'fail', '✗ Failed to initialize marquee');
      }
    }

    function runTest2() {
      const container = document.querySelector('[data-test-id="2"] .marquee-container');
      const instance = window.Marquee.get(container);

      if (instance && instance.coreConfig.direction === 'vertical') {
        markTest(2, 'pass', '✓ Vertical marquee detected and animating');
      } else {
        markTest(2, 'fail', '✗ Direction not set to vertical');
      }
    }

    function runTest3() {
      const container = document.querySelector('[data-test-id="3"] .marquee-container');
      const instance = window.Marquee.get(container);

      if (instance && instance.timeline.timeScale() < 0) {
        markTest(3, 'pass', '✓ Reverse animation confirmed (negative timeScale)');
      } else {
        markTest(3, 'fail', '✗ Animation not reversed');
      }
    }

    function runTest4() {
      const container = document.querySelector('[data-test-id="4"] .marquee-container');
      const instance = window.Marquee.get(container);

      if (instance && instance.coreConfig.speed === 2) {
        markTest(4, 'pass', '✓ Speed set to 2x');
      } else {
        markTest(4, 'fail', '✗ Speed not set correctly');
      }
    }

    function runTest5() {
      const container = document.querySelector('[data-test-id="5"] .marquee-container');
      const allItems = container.querySelectorAll('[data-marquee-item]');
      const originalItems = container.querySelectorAll('[data-marquee-item]:not([data-marquee-clone])');
      const cloneCount = (allItems.length - originalItems.length) / originalItems.length;

      if (cloneCount >= 4) {
        markTest(5, 'pass', `✓ Clone count: ${cloneCount} (check console with ?marquee-debug)`);
      } else {
        markTest(5, 'fail', `✗ Clone count: ${cloneCount} (expected 4+)`);
      }
    }

    function runTest6() {
      const container = document.querySelector('[data-test-id="6"] .marquee-container');
      const allItems = container.querySelectorAll('[data-marquee-item]');
      const originalItems = container.querySelectorAll('[data-marquee-item]:not([data-marquee-clone])');
      const cloneCount = (allItems.length - originalItems.length) / originalItems.length;

      // Calculate expected clone count based on container width
      const containerWidth = container.clientWidth;
      const maxReasonableClones = Math.ceil((containerWidth * 2) / 500); // ~500px of content

      if (cloneCount <= maxReasonableClones && cloneCount < 6) {
        markTest(6, 'pass', `✓ Clone count: ${cloneCount} (optimized for ${containerWidth}px container)`);
      } else {
        markTest(6, 'fail', `✗ Clone count: ${cloneCount} (expected ≤${maxReasonableClones} for this screen)`);
      }
    }

    function runTest7() {
      const container = document.querySelector('[data-test-id="7"] .marquee-container');
      const allItems = container.querySelectorAll('[data-marquee-item]');
      const originalItems = container.querySelectorAll('[data-marquee-item]:not([data-marquee-clone])');
      const cloneCount = (allItems.length - originalItems.length) / originalItems.length;

      if (cloneCount === 3) {
        markTest(7, 'pass', `✓ Clone count: 3 (manual override respected)`);
      } else {
        markTest(7, 'fail', `✗ Clone count: ${cloneCount} (expected 3)`);
      }
    }

    function runTest8() {
      markTest(8, 'pass', '✓ Click "Toggle Direction" to test automatic rebuild');
    }

    function runTest9() {
      markTest(9, 'pass', '✓ Use buttons to test manual direction refresh');
    }

    function runTest10() {
      markTest(10, 'pass', '✓ Check console for CSS reverse warning');
    }

    function runTest11() {
      markTest(11, 'pass', '✓ Use "Pause All" / "Play All" buttons to test');
    }

    function runTest12() {
      const container = document.getElementById('test12-marquee');
      const instances = window.Marquee.getAll('.api-test');
      const hasInstance = window.Marquee.has(container);

      document.getElementById('test12-output').textContent =
        `getAll('.api-test'): ${instances.length} instance(s)\nhas(element): ${hasInstance}`;

      if (instances.length > 0 && hasInstance) {
        markTest(12, 'pass', '✓ API methods return correct values');
      } else {
        markTest(12, 'fail', '✗ API methods not working correctly');
      }
    }

    function runTest13() {
      markTest(13, 'pass', '✓ Use buttons to test refreshAll()');
    }

    function runTest14() {
      markTest(14, 'pass', '✓ Click "Test Chaining" to verify chainable API');
    }

    function runTest15() {
      markTest(15, 'pass', '✓ Watch animation - should play once and stop (fast speed)');
    }

    function runTest16() {
      markTest(16, 'pass', '✓ Watch animation - should loop 3 times and stop');
    }

    function runTest17() {
      markTest(17, 'pass', '✓ Check console for helpful warning message');
    }

    function runTest18() {
      markTest(18, 'pass', '✓ Check console for CSS validation warnings');
    }

    function runTest19() {
      markTest(19, 'pass', '✓ Check console for clone count cap warning');
    }

    function runTest20() {
      markTest(20, 'pass', '✓ Hover to pause, toggle direction, hover again to verify');
    }

    // Wire up test buttons
    const testRunners = [
      runTest1, runTest2, runTest3, runTest4, runTest5,
      runTest6, runTest7, runTest8, runTest9, runTest10,
      runTest11, runTest12, runTest13, runTest14, runTest15,
      runTest16, runTest17, runTest18, runTest19, runTest20
    ];

    document.querySelectorAll('.run-test').forEach((btn, index) => {
      btn.addEventListener('click', () => testRunners[index]());
    });

    // Interactive controls
    document.getElementById('toggle-direction')?.addEventListener('click', () => {
      const container = document.getElementById('test8-marquee');
      container.classList.toggle('vertical');
      container.style.height = container.classList.contains('vertical') ? '300px' : 'auto';
    });

    document.getElementById('manual-toggle')?.addEventListener('click', () => {
      const container = document.getElementById('test9-marquee');
      container.classList.toggle('vertical');
      container.style.height = container.classList.contains('vertical') ? '300px' : 'auto';
    });

    document.getElementById('manual-refresh')?.addEventListener('click', () => {
      const container = document.getElementById('test9-marquee');
      window.Marquee.refresh(container);
    });

    document.getElementById('pause-all')?.addEventListener('click', () => {
      window.Marquee.pauseAll('.test-group');
    });

    document.getElementById('play-all')?.addEventListener('click', () => {
      window.Marquee.playAll('.test-group');
    });

    document.getElementById('toggle-all')?.addEventListener('click', () => {
      document.querySelectorAll('.refresh-test').forEach(el => {
        el.classList.toggle('vertical');
        el.style.height = el.classList.contains('vertical') ? '300px' : 'auto';
      });
    });

    document.getElementById('refresh-all')?.addEventListener('click', () => {
      window.Marquee.refreshAll('.refresh-test');
    });

    document.getElementById('test-chain')?.addEventListener('click', () => {
      window.Marquee.pauseAll().playAll('.chain-test');
    });

    document.getElementById('toggle-hover-direction')?.addEventListener('click', () => {
      const container = document.getElementById('test20-marquee');
      container.classList.toggle('vertical');
      container.style.height = container.classList.contains('vertical') ? '300px' : 'auto';
    });

    // Initialize stats
    updateStats();
  </script>
</body>
</html>
