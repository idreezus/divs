{"version":3,"file":"modal.min.js","sources":["../../../packages/modal/src/config.js","../../../packages/modal/src/utils.js","../../../packages/modal/src/scroll-lock.js","../../../packages/modal/src/core.js","../../../packages/modal/src/modal.js"],"sourcesContent":["// Configuration constants for the modal library\n\n// Builds a presence-based selector with opt-out support\nconst sel = (attr) => `[${attr}]:not([${attr}=\"false\"])`;\n\n// Raw attribute names for marker (presence-based) elements\nexport const selectorAttrs = {\n  close: 'data-modal-close',\n  closeTemplate: 'data-modal-close-template',\n};\n\n// DOM query selectors (marker attrs auto-derived, value attrs manual)\nexport const selectors = {\n  ...Object.fromEntries(\n    Object.entries(selectorAttrs).map(([k, v]) => [k, sel(v)])\n  ),\n  modal: '[data-modal-value]',\n  trigger: '[data-modal-trigger-value]',\n};\n\n// Data attribute names for getAttribute/hasAttribute\nexport const attributes = {\n  value: 'data-modal-value',\n  triggerValue: 'data-modal-trigger-value',\n  urlParam: 'data-modal-url-param',\n  scrollLock: 'data-modal-scroll-lock',\n  position: 'data-modal-position',\n  wrapped: 'data-modal-wrapped',\n  close: 'data-modal-close',\n  closeTemplate: 'data-modal-close-template',\n};\n\n// CSS class names for state management\nexport const classes = {\n  bodyOpen: 'modal-open',\n  closeDefault: 'modal-close-default',\n  positionCenter: 'modal-center',\n  positionLeft: 'modal-left',\n  positionRight: 'modal-right',\n  positionTop: 'modal-top',\n  positionBottom: 'modal-bottom',\n};\n\n// Default configuration values\nexport const defaults = {\n  scrollLock: true,\n  position: 'center',\n};\n\n// Valid position values for validation\nexport const validPositions = ['center', 'left', 'right', 'top', 'bottom'];\n","// Shared utility functions for the modal library\n\nlet idCounter = 0;\n\n// Generates a unique ID for each modal instance\nexport function generateUniqueId() {\n  idCounter += 1;\n  return `modal-${idCounter}`;\n}\n\n// Normalizes a value string to lowercase, hyphenated format\nexport function normalizeValue(value) {\n  if (!value) return '';\n  return value.toLowerCase().replace(/\\s+/g, '-');\n}\n","// Scroll lock module for modal dialogs\n\nimport { classes } from './config.js';\n\n// Track number of open modals for nested scroll lock\nlet openCount = 0;\nlet scrollY = 0;\n\n// Locks body scroll when a modal opens\nexport function lock() {\n  openCount += 1;\n\n  // Only lock on first modal\n  if (openCount === 1) {\n    scrollY = window.scrollY;\n    document.body.classList.add(classes.bodyOpen);\n  }\n}\n\n// Unlocks body scroll when a modal closes\nexport function unlock() {\n  openCount -= 1;\n\n  // Only unlock when all modals are closed\n  if (openCount <= 0) {\n    openCount = 0;\n    document.body.classList.remove(classes.bodyOpen);\n    window.scrollTo(0, scrollY);\n  }\n}\n","// Core modal library with Modal class and initialization logic\n\nimport {\n  selectors,\n  attributes,\n  classes,\n  defaults,\n  validPositions,\n} from './config.js';\nimport { generateUniqueId, normalizeValue } from './utils.js';\nimport { lock, unlock } from './scroll-lock.js';\n\n// Parses configuration from data attributes on the dialog element\nfunction parseConfig(dialog) {\n  const positionAttr = dialog.getAttribute(attributes.position);\n  let position = defaults.position;\n\n  if (positionAttr) {\n    const normalizedPosition = positionAttr.toLowerCase();\n    if (validPositions.includes(normalizedPosition)) {\n      position = normalizedPosition;\n    } else {\n      console.warn(\n        `Modal: Invalid position \"${positionAttr}\". Valid values: ${validPositions.join(', ')}. Defaulting to \"${defaults.position}\".`\n      );\n    }\n  }\n\n  return {\n    scrollLock: dialog.getAttribute(attributes.scrollLock) !== 'false',\n    urlParam: dialog.getAttribute(attributes.urlParam) || null,\n    position,\n  };\n}\n\n// Wraps a non-dialog element in a real <dialog>\nfunction ensureDialog(element) {\n  if (element.tagName === 'DIALOG') {\n    return element;\n  }\n\n  const dialog = document.createElement('dialog');\n\n  // Copy ONLY data-modal-* attributes to dialog\n  [...element.attributes].forEach((attr) => {\n    if (attr.name.startsWith('data-modal')) {\n      dialog.setAttribute(attr.name, attr.value);\n    }\n  });\n\n  // Mark as wrapped\n  dialog.setAttribute(attributes.wrapped, '');\n\n  // Move element inside dialog (retains ALL original classes, styles, other attributes)\n  element.replaceWith(dialog);\n  dialog.appendChild(element);\n\n  return dialog;\n}\n\n// Ensures a close button exists, injecting default if needed\nfunction ensureCloseButton(instance) {\n  const { dialog } = instance;\n\n  // Check if user provided close button\n  if (dialog.querySelector(selectors.close)) {\n    return;\n  }\n\n  // Check for template anywhere in document\n  const template = document.querySelector(selectors.closeTemplate);\n  let closeBtn;\n\n  if (template) {\n    closeBtn = template.cloneNode(true);\n    closeBtn.removeAttribute(attributes.closeTemplate);\n  } else {\n    closeBtn = document.createElement('button');\n    closeBtn.setAttribute('type', 'button');\n    closeBtn.setAttribute('aria-label', 'Close dialog');\n    closeBtn.className = classes.closeDefault;\n    closeBtn.textContent = 'Ã—';\n  }\n\n  closeBtn.setAttribute(attributes.close, '');\n\n  // Insert after first heading, or as first child\n  const heading = dialog.querySelector('h1, h2, h3, h4, h5, h6');\n  if (heading) {\n    heading.after(closeBtn);\n  } else {\n    dialog.prepend(closeBtn);\n  }\n}\n\n// Sets up backdrop click to close using native closedby or fallback\nfunction setupBackdropClose(instance) {\n  const { dialog } = instance;\n\n  // Use native closedby if supported\n  if ('closedBy' in HTMLDialogElement.prototype) {\n    dialog.closedBy = 'any';\n    return;\n  }\n\n  // Fallback: detect clicks on dialog element itself (backdrop area)\n  const handler = (e) => {\n    if (e.target === dialog) {\n      dialog.close();\n    }\n  };\n\n  dialog.addEventListener('click', handler);\n  instance.boundHandlers.backdropClick = handler;\n}\n\n// Sets up aria-controls on trigger if not already set\nfunction setupTriggerAria(trigger, dialog) {\n  if (!trigger.hasAttribute('aria-controls')) {\n    // Ensure dialog has an ID\n    if (!dialog.id) {\n      dialog.id = `modal-dialog-${Date.now()}`;\n    }\n    trigger.setAttribute('aria-controls', dialog.id);\n  }\n}\n\n// Finds a modal by its normalized value\nfunction findModalByValue(value) {\n  const modals = document.querySelectorAll(selectors.modal);\n  for (const modal of modals) {\n    const modalValue = normalizeValue(modal.getAttribute(attributes.value));\n    if (modalValue === value) {\n      return modal;\n    }\n  }\n  return null;\n}\n\n// Handles trigger click, opening modal or replacing current modal\nfunction handleTriggerClick(trigger, targetValue) {\n  // Check if trigger is inside an open modal\n  const parentModal = trigger.closest('dialog[open]');\n\n  if (parentModal && parentModal._modal) {\n    // Close current modal, then open next\n    parentModal.close();\n\n    const targetDialog = findModalByValue(targetValue);\n    if (targetDialog && targetDialog._modal) {\n      targetDialog._modal.open();\n    } else {\n      throw new Error(`Modal not found: \"${targetValue}\"`);\n    }\n  } else {\n    // Normal open from trigger\n    const targetDialog = findModalByValue(targetValue);\n    if (!targetDialog) {\n      throw new Error(`Modal not found: \"${targetValue}\"`);\n    }\n\n    if (targetDialog._modal) {\n      targetDialog._modal.open();\n    }\n  }\n}\n\n// Attaches event listeners for close buttons and native close event\nfunction attachEventListeners(instance) {\n  const { dialog } = instance;\n\n  // Close button listeners\n  const closeButtons = dialog.querySelectorAll(selectors.close);\n  instance.boundHandlers.closeButtons = [];\n\n  closeButtons.forEach((btn) => {\n    const handler = () => dialog.close();\n    btn.addEventListener('click', handler);\n    instance.boundHandlers.closeButtons.push({ btn, handler });\n  });\n\n  // Listen for native close event to handle scroll unlock\n  const closeHandler = () => {\n    instance.state.isOpen = false;\n    if (instance.config.scrollLock) {\n      unlock();\n    }\n    updateUrl(instance, 'close');\n  };\n\n  dialog.addEventListener('close', closeHandler);\n  instance.boundHandlers.close = closeHandler;\n}\n\n// Updates URL query parameter based on modal open/close state\nfunction updateUrl(instance, action) {\n  const { dialog, config } = instance;\n  const paramName = config.urlParam;\n\n  if (!paramName) return;\n\n  const url = new URL(window.location.href);\n\n  if (action === 'open') {\n    url.searchParams.set(paramName, '');\n  } else {\n    url.searchParams.delete(paramName);\n  }\n\n  history.replaceState(null, '', url.toString());\n}\n\n// Applies the position class to the dialog element\nfunction applyPositionClass(instance) {\n  const { dialog, config } = instance;\n  const positionClass = `modal-${config.position}`;\n  dialog.classList.add(positionClass);\n}\n\n// Initializes a modal instance\nfunction init(instance) {\n  const { dialog, id } = instance;\n\n  // Validate we have a dialog\n  if (!dialog || dialog.tagName !== 'DIALOG') {\n    console.warn(`Modal ${id}: Invalid dialog element`);\n    return false;\n  }\n\n  // Apply position class\n  applyPositionClass(instance);\n\n  // Ensure close button exists\n  ensureCloseButton(instance);\n\n  // Setup backdrop close behavior\n  setupBackdropClose(instance);\n\n  // Attach event listeners\n  attachEventListeners(instance);\n\n  return true;\n}\n\n// Cleans up all event listeners\nfunction cleanup(instance) {\n  const { dialog, boundHandlers } = instance;\n\n  // Remove close button listeners\n  if (boundHandlers.closeButtons) {\n    boundHandlers.closeButtons.forEach(({ btn, handler }) => {\n      btn.removeEventListener('click', handler);\n    });\n  }\n\n  // Remove close event listener\n  if (boundHandlers.close) {\n    dialog.removeEventListener('close', boundHandlers.close);\n  }\n\n  // Remove backdrop click listener\n  if (boundHandlers.backdropClick) {\n    dialog.removeEventListener('click', boundHandlers.backdropClick);\n  }\n}\n\n// Main Modal class\nexport class Modal {\n  constructor(dialog) {\n    this.id = generateUniqueId();\n    this.dialog = dialog;\n    this.value = normalizeValue(dialog.getAttribute(attributes.value));\n    this.config = parseConfig(dialog);\n\n    this.state = {\n      isOpen: false,\n    };\n\n    this.boundHandlers = {};\n\n    const initialized = init(this);\n    if (initialized) {\n      this.dialog._modal = this;\n    } else {\n      console.warn(`Modal ${this.id}: Initialization failed`);\n    }\n  }\n\n  // Opens the modal\n  open() {\n    const { dialog, state, config } = this;\n\n    // No-op if already open\n    if (state.isOpen) return this;\n\n    // Lock scroll\n    if (config.scrollLock) {\n      lock();\n    }\n\n    dialog.showModal();\n    state.isOpen = true;\n\n    // Update URL\n    updateUrl(this, 'open');\n\n    return this;\n  }\n\n  // Closes the modal\n  close() {\n    const { dialog, state } = this;\n\n    // close() triggers the 'close' event which handles cleanup\n    if (state.isOpen) {\n      dialog.close();\n    }\n\n    return this;\n  }\n\n  // Re-initializes the modal after DOM changes\n  refresh() {\n    // Clean up current listeners\n    cleanup(this);\n\n    // Re-initialize\n    this.boundHandlers = {};\n    init(this);\n\n    return this;\n  }\n\n  // Destroys the modal instance and cleans up\n  destroy() {\n    cleanup(this);\n\n    // Remove instance reference\n    delete this.dialog._modal;\n\n    // Clear all properties\n    this.dialog = null;\n    this.config = null;\n    this.state = null;\n    this.boundHandlers = null;\n  }\n}\n\n// Sets up global trigger listeners via event delegation\nexport function setupTriggerListeners() {\n  // Use event delegation on document for all triggers\n  document.addEventListener('click', (e) => {\n    const trigger = e.target.closest(selectors.trigger);\n    if (!trigger) return;\n\n    e.preventDefault();\n\n    const targetValue = normalizeValue(\n      trigger.getAttribute(attributes.triggerValue)\n    );\n\n    // Setup aria-controls if not set\n    const targetDialog = findModalByValue(targetValue);\n    if (targetDialog) {\n      setupTriggerAria(trigger, targetDialog);\n    }\n\n    handleTriggerClick(trigger, targetValue);\n  });\n}\n\n// Opens modals based on URL parameters\nexport function openFromUrl() {\n  const params = new URLSearchParams(window.location.search);\n\n  document.querySelectorAll(`[${attributes.urlParam}]`).forEach((dialog) => {\n    const paramName = dialog.getAttribute(attributes.urlParam);\n    if (params.has(paramName) && dialog._modal) {\n      dialog._modal.open();\n    }\n  });\n}\n\n// Export for use in modal.js\nexport { ensureDialog };\n","// Entry point for modal library, handles auto-initialization\n\nimport { selectors, attributes } from './config.js';\nimport { Modal, ensureDialog, setupTriggerListeners, openFromUrl } from './core.js';\n\n// Auto-initializes all modals on the page\nfunction autoInit() {\n  // Find all modal elements\n  const modalElements = document.querySelectorAll(selectors.modal);\n\n  modalElements.forEach((element) => {\n    // Skip if already initialized\n    if (element._modal) return;\n\n    try {\n      // Wrap non-dialog elements in <dialog>\n      const dialog = ensureDialog(element);\n\n      // Create modal instance\n      new Modal(dialog);\n    } catch (error) {\n      console.warn('Modal auto-initialization failed:', error);\n    }\n  });\n\n  // Setup global trigger listeners (event delegation)\n  setupTriggerListeners();\n\n  // Check URL for deep-linked modals\n  openFromUrl();\n}\n\n// Execute on DOMContentLoaded or immediately if DOM is already ready\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', autoInit);\n} else {\n  autoInit();\n}\n\n// Export Modal class for module usage\nexport { Modal };\n"],"names":["selectors","Object","fromEntries","entries","close","closeTemplate","map","k","v","attr","modal","trigger","attributes","classes","defaults","validPositions","idCounter","normalizeValue","value","toLowerCase","replace","openCount","scrollY","findModalByValue","modals","document","querySelectorAll","getAttribute","attachEventListeners","instance","dialog","closeButtons","boundHandlers","forEach","btn","handler","addEventListener","push","closeHandler","state","isOpen","config","scrollLock","body","classList","remove","window","scrollTo","updateUrl","action","paramName","urlParam","url","URL","location","href","searchParams","set","delete","history","replaceState","toString","init","id","tagName","positionClass","position","add","applyPositionClass","querySelector","template","closeBtn","cloneNode","removeAttribute","createElement","setAttribute","className","textContent","heading","after","prepend","ensureCloseButton","HTMLDialogElement","prototype","closedBy","e","target","backdropClick","setupBackdropClose","console","warn","cleanup","removeEventListener","Modal","constructor","this","positionAttr","normalizedPosition","includes","join","parseConfig","_modal","open","showModal","refresh","destroy","setupTriggerListeners","closest","preventDefault","targetValue","targetDialog","hasAttribute","Date","now","setupTriggerAria","parentModal","Error","handleTriggerClick","autoInit","element","name","startsWith","replaceWith","appendChild","ensureDialog","error","params","URLSearchParams","search","has","openFromUrl","readyState"],"mappings":"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"}