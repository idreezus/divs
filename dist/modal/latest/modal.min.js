/*!
 * Modal v1.0.0
 * A lightweight modal library built on native HTML dialog elements.
 *
 * A part of Divs by Idreezus, a component library
 * divs.idreezus.com
 *
 * (c) 2026 Idrees Isse (https://github.com/idreezus)
 * Released under AGPL-3.0
 */
var Modal=function(t){"use strict";const e={...Object.fromEntries(Object.entries({close:"data-modal-close",closeTemplate:"data-modal-close-template"}).map(([t,e])=>{return[t,(o=e,`[${o}]:not([${o}="false"])`)];var o})),modal:"[data-modal-value]",trigger:"[data-modal-trigger-value]"},o="data-modal-value",n="data-modal-trigger-value",a="data-modal-url-param",l="data-modal-scroll-lock",s="data-modal-position",i="data-modal-wrapped",r="data-modal-close",c="data-modal-close-template",d="modal-open",u="modal-close-default",m="center",h=["center","left","right","top","bottom"];let f=0;function g(t){return t?t.toLowerCase().replace(/\s+/g,"-"):""}let p=0,b=0;function v(t){const n=document.querySelectorAll(e.modal);for(const e of n){if(g(e.getAttribute(o))===t)return e}return null}function w(t){const{dialog:o}=t,n=o.querySelectorAll(e.close);t.boundHandlers.closeButtons=[],n.forEach(e=>{const n=()=>o.close();e.addEventListener("click",n),t.boundHandlers.closeButtons.push({btn:e,handler:n})});const a=()=>{t.state.isOpen=!1,t.config.scrollLock&&(p-=1,p<=0&&(p=0,document.body.classList.remove(d),window.scrollTo(0,b))),L(t,"close")};o.addEventListener("close",a),t.boundHandlers.close=a}function L(t,e){const{dialog:o,config:n}=t,a=n.urlParam;if(!a)return;const l=new URL(window.location.href);"open"===e?l.searchParams.set(a,""):l.searchParams.delete(a),history.replaceState(null,"",l.toString())}function A(t){const{dialog:o,id:n}=t;return o&&"DIALOG"===o.tagName?(function(t){const{dialog:e,config:o}=t,n=`modal-${o.position}`;e.classList.add(n)}(t),function(t){const{dialog:o}=t;if(o.querySelector(e.close))return;const n=document.querySelector(e.closeTemplate);let a;n?(a=n.cloneNode(!0),a.removeAttribute(c)):(a=document.createElement("button"),a.setAttribute("type","button"),a.setAttribute("aria-label","Close dialog"),a.className=u,a.textContent="Ã—"),a.setAttribute(r,"");const l=o.querySelector("h1, h2, h3, h4, h5, h6");l?l.after(a):o.prepend(a)}(t),function(t){const{dialog:e}=t;if("closedBy"in HTMLDialogElement.prototype)return void(e.closedBy="any");const o=t=>{t.target===e&&e.close()};e.addEventListener("click",o),t.boundHandlers.backdropClick=o}(t),w(t),!0):(console.warn(`Modal ${n}: Invalid dialog element`),!1)}function E(t){const{dialog:e,boundHandlers:o}=t;o.closeButtons&&o.closeButtons.forEach(({btn:t,handler:e})=>{t.removeEventListener("click",e)}),o.close&&e.removeEventListener("close",o.close),o.backdropClick&&e.removeEventListener("click",o.backdropClick)}class y{constructor(t){this.id=(f+=1,`modal-${f}`),this.dialog=t,this.value=g(t.getAttribute(o)),this.config=function(t){const e=t.getAttribute(s);let o=m;if(e){const t=e.toLowerCase();h.includes(t)?o=t:console.warn(`Modal: Invalid position "${e}". Valid values: ${h.join(", ")}. Defaulting to "${m}".`)}return{scrollLock:"false"!==t.getAttribute(l),urlParam:t.getAttribute(a)||null,position:o}}(t),this.state={isOpen:!1},this.boundHandlers={};A(this)?this.dialog._modal=this:console.warn(`Modal ${this.id}: Initialization failed`)}open(){const{dialog:t,state:e,config:o}=this;return e.isOpen||(o.scrollLock&&(p+=1,1===p&&(b=window.scrollY,document.body.classList.add(d))),t.showModal(),e.isOpen=!0,L(this,"open")),this}close(){const{dialog:t,state:e}=this;return e.isOpen&&t.close(),this}refresh(){return E(this),this.boundHandlers={},A(this),this}destroy(){E(this),delete this.dialog._modal,this.dialog=null,this.config=null,this.state=null,this.boundHandlers=null}}function k(){document.addEventListener("click",t=>{const o=t.target.closest(e.trigger);if(!o)return;t.preventDefault();const a=g(o.getAttribute(n)),l=v(a);l&&function(t,e){t.hasAttribute("aria-controls")||(e.id||(e.id=`modal-dialog-${Date.now()}`),t.setAttribute("aria-controls",e.id))}(o,l),function(t,e){const o=t.closest("dialog[open]");if(o&&o._modal){o.close();const t=v(e);if(!t||!t._modal)throw new Error(`Modal not found: "${e}"`);t._modal.open()}else{const t=v(e);if(!t)throw new Error(`Modal not found: "${e}"`);t._modal&&t._modal.open()}}(o,a)})}function $(){document.querySelectorAll(e.modal).forEach(t=>{if(!t._modal)try{const e=function(t){if("DIALOG"===t.tagName)return t;const e=document.createElement("dialog");return[...t.attributes].forEach(t=>{t.name.startsWith("data-modal")&&e.setAttribute(t.name,t.value)}),e.setAttribute(i,""),t.replaceWith(e),e.appendChild(t),e}(t);new y(e)}catch(t){console.warn("Modal auto-initialization failed:",t)}}),k(),function(){const t=new URLSearchParams(window.location.search);document.querySelectorAll(`[${a}]`).forEach(e=>{const o=e.getAttribute(a);t.has(o)&&e._modal&&e._modal.open()})}()}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",$):$(),t.Modal=y,t}({});
//# sourceMappingURL=modal.min.js.map
