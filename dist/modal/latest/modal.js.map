{"version":3,"file":"modal.js","sources":["../../../packages/modal/src/config.js","../../../packages/modal/src/utils.js","../../../packages/modal/src/scroll-lock.js","../../../packages/modal/src/core.js","../../../packages/modal/src/modal.js"],"sourcesContent":["/**\n * Modal configuration constants\n *\n * Organized by type following the component design guidelines:\n * - selectors: DOM query strings\n * - attributes: Data attribute names\n * - classes: CSS class names for state\n * - defaults: Fallback configuration values\n */\n\n// DOM query selectors for querySelectorAll\nexport const selectors = {\n  modal: '[data-modal-value]',\n  trigger: '[data-modal-trigger-value]',\n  close: '[data-modal-close]',\n  closeTemplate: '[data-modal-close-template]',\n};\n\n// Data attribute names for getAttribute/hasAttribute\nexport const attributes = {\n  value: 'data-modal-value',\n  triggerValue: 'data-modal-trigger-value',\n  urlParam: 'data-modal-url-param',\n  scrollLock: 'data-modal-scroll-lock',\n  wrapped: 'data-modal-wrapped',\n  close: 'data-modal-close',\n  closeTemplate: 'data-modal-close-template',\n};\n\n// CSS class names for state management\nexport const classes = {\n  bodyOpen: 'modal-open',\n  closeDefault: 'modal-close-default',\n};\n\n// Default configuration values\nexport const defaults = {\n  scrollLock: true,\n};\n","/**\n * Shared utility functions for the modal library\n */\n\nlet idCounter = 0;\n\n/**\n * Generates a unique ID for each modal instance\n * @returns {string} Unique modal ID (e.g., 'modal-1')\n */\nexport function generateUniqueId() {\n  idCounter += 1;\n  return `modal-${idCounter}`;\n}\n\n/**\n * Normalizes a value string to lowercase, hyphenated format\n * @param {string} value - The value to normalize\n * @returns {string} Normalized value\n */\nexport function normalizeValue(value) {\n  if (!value) return '';\n  return value.toLowerCase().replace(/\\s+/g, '-');\n}\n","/**\n * Scroll lock module for modal dialogs\n *\n * Preserves scroll position when modal opens and restores it when closed.\n * Adds 'modal-open' class to body for CSS scroll lock (user provides CSS).\n *\n * Example user CSS:\n * body.modal-open { overflow: hidden; }\n */\n\nimport { classes } from './config.js';\n\n// Track number of open modals for nested scroll lock\nlet openCount = 0;\nlet scrollY = 0;\n\n/**\n * Locks body scroll when a modal opens\n * Only applies on first modal open (supports multiple open modals)\n */\nexport function lock() {\n  openCount += 1;\n\n  // Only lock on first modal\n  if (openCount === 1) {\n    scrollY = window.scrollY;\n    document.body.classList.add(classes.bodyOpen);\n  }\n}\n\n/**\n * Unlocks body scroll when a modal closes\n * Only restores on last modal close\n */\nexport function unlock() {\n  openCount -= 1;\n\n  // Only unlock when all modals are closed\n  if (openCount <= 0) {\n    openCount = 0;\n    document.body.classList.remove(classes.bodyOpen);\n    window.scrollTo(0, scrollY);\n  }\n}\n","/**\n * Modal core module\n *\n * Main Modal class and lifecycle management built on native <dialog>.\n * Handles initialization, triggers, close buttons, and cleanup.\n */\n\nimport { selectors, attributes, classes, defaults } from './config.js';\nimport { generateUniqueId, normalizeValue } from './utils.js';\nimport { lock, unlock } from './scroll-lock.js';\n\n/**\n * Parses configuration from data attributes\n * @param {HTMLDialogElement} dialog - The dialog element\n * @returns {Object} Parsed configuration\n */\nfunction parseConfig(dialog) {\n  return {\n    scrollLock: dialog.getAttribute(attributes.scrollLock) !== 'false',\n    urlParam: dialog.getAttribute(attributes.urlParam) || null,\n  };\n}\n\n/**\n * Wraps a non-dialog element in a real <dialog>\n * @param {HTMLElement} element - Element with data-modal-value\n * @returns {HTMLDialogElement} The dialog element (original or wrapper)\n */\nfunction ensureDialog(element) {\n  if (element.tagName === 'DIALOG') {\n    return element;\n  }\n\n  const dialog = document.createElement('dialog');\n\n  // Copy ONLY data-modal-* attributes to dialog\n  [...element.attributes].forEach((attr) => {\n    if (attr.name.startsWith('data-modal')) {\n      dialog.setAttribute(attr.name, attr.value);\n    }\n  });\n\n  // Mark as wrapped\n  dialog.setAttribute(attributes.wrapped, '');\n\n  // Move element inside dialog (retains ALL original classes, styles, other attributes)\n  element.replaceWith(dialog);\n  dialog.appendChild(element);\n\n  return dialog;\n}\n\n/**\n * Ensures a close button exists in the modal\n * Injects default or clones from template if not present\n * @param {Object} instance - Modal instance\n */\nfunction ensureCloseButton(instance) {\n  const { dialog } = instance;\n\n  // Check if user provided close button\n  if (dialog.querySelector(selectors.close)) {\n    return;\n  }\n\n  // Check for template anywhere in document\n  const template = document.querySelector(selectors.closeTemplate);\n  let closeBtn;\n\n  if (template) {\n    closeBtn = template.cloneNode(true);\n    closeBtn.removeAttribute(attributes.closeTemplate);\n  } else {\n    closeBtn = document.createElement('button');\n    closeBtn.setAttribute('type', 'button');\n    closeBtn.setAttribute('aria-label', 'Close dialog');\n    closeBtn.className = classes.closeDefault;\n    closeBtn.textContent = 'Ã—';\n  }\n\n  closeBtn.setAttribute(attributes.close, '');\n\n  // Insert after first heading, or as first child\n  const heading = dialog.querySelector('h1, h2, h3, h4, h5, h6');\n  if (heading) {\n    heading.after(closeBtn);\n  } else {\n    dialog.prepend(closeBtn);\n  }\n}\n\n/**\n * Sets up backdrop click to close behavior\n * Uses native closedby=\"any\" if supported, otherwise fallback\n * @param {Object} instance - Modal instance\n */\nfunction setupBackdropClose(instance) {\n  const { dialog } = instance;\n\n  // Use native closedby if supported\n  if ('closedBy' in HTMLDialogElement.prototype) {\n    dialog.closedBy = 'any';\n    return;\n  }\n\n  // Fallback: detect clicks on dialog element itself (backdrop area)\n  const handler = (e) => {\n    if (e.target === dialog) {\n      dialog.close();\n    }\n  };\n\n  dialog.addEventListener('click', handler);\n  instance.boundHandlers.backdropClick = handler;\n}\n\n/**\n * Sets up aria-controls on trigger if not already set\n * @param {HTMLElement} trigger - Trigger element\n * @param {HTMLDialogElement} dialog - Target dialog\n */\nfunction setupTriggerAria(trigger, dialog) {\n  if (!trigger.hasAttribute('aria-controls')) {\n    // Ensure dialog has an ID\n    if (!dialog.id) {\n      dialog.id = `modal-dialog-${Date.now()}`;\n    }\n    trigger.setAttribute('aria-controls', dialog.id);\n  }\n}\n\n/**\n * Finds a modal by its normalized value\n * @param {string} value - Normalized modal value\n * @returns {HTMLDialogElement|null} The dialog element or null\n */\nfunction findModalByValue(value) {\n  const modals = document.querySelectorAll(selectors.modal);\n  for (const modal of modals) {\n    const modalValue = normalizeValue(modal.getAttribute(attributes.value));\n    if (modalValue === value) {\n      return modal;\n    }\n  }\n  return null;\n}\n\n/**\n * Handles trigger click - opens modal, handles replacement\n * @param {HTMLElement} trigger - The clicked trigger\n * @param {string} targetValue - Normalized target modal value\n */\nfunction handleTriggerClick(trigger, targetValue) {\n  // Check if trigger is inside an open modal\n  const parentModal = trigger.closest('dialog[open]');\n\n  if (parentModal && parentModal._modal) {\n    // Close current modal, then open next\n    parentModal.close();\n\n    const targetDialog = findModalByValue(targetValue);\n    if (targetDialog && targetDialog._modal) {\n      targetDialog._modal.open();\n    } else {\n      throw new Error(`Modal not found: \"${targetValue}\"`);\n    }\n  } else {\n    // Normal open from trigger\n    const targetDialog = findModalByValue(targetValue);\n    if (!targetDialog) {\n      throw new Error(`Modal not found: \"${targetValue}\"`);\n    }\n\n    if (targetDialog._modal) {\n      targetDialog._modal.open();\n    }\n  }\n}\n\n/**\n * Attaches event listeners for triggers and close buttons\n * @param {Object} instance - Modal instance\n */\nfunction attachEventListeners(instance) {\n  const { dialog } = instance;\n\n  // Close button listeners\n  const closeButtons = dialog.querySelectorAll(selectors.close);\n  instance.boundHandlers.closeButtons = [];\n\n  closeButtons.forEach((btn) => {\n    const handler = () => dialog.close();\n    btn.addEventListener('click', handler);\n    instance.boundHandlers.closeButtons.push({ btn, handler });\n  });\n\n  // Listen for native close event to handle scroll unlock\n  const closeHandler = () => {\n    instance.state.isOpen = false;\n    if (instance.config.scrollLock) {\n      unlock();\n    }\n    updateUrl(instance, 'close');\n  };\n\n  dialog.addEventListener('close', closeHandler);\n  instance.boundHandlers.close = closeHandler;\n}\n\n/**\n * Updates URL based on modal state\n * @param {Object} instance - Modal instance\n * @param {string} action - 'open' or 'close'\n */\nfunction updateUrl(instance, action) {\n  const { dialog, config } = instance;\n  const paramName = config.urlParam;\n\n  if (!paramName) return;\n\n  const url = new URL(window.location.href);\n\n  if (action === 'open') {\n    url.searchParams.set(paramName, '');\n  } else {\n    url.searchParams.delete(paramName);\n  }\n\n  history.replaceState(null, '', url.toString());\n}\n\n/**\n * Initializes a modal instance\n * @param {Object} instance - Modal instance\n * @returns {boolean} Whether initialization succeeded\n */\nfunction init(instance) {\n  const { dialog, id } = instance;\n\n  // Validate we have a dialog\n  if (!dialog || dialog.tagName !== 'DIALOG') {\n    console.warn(`Modal ${id}: Invalid dialog element`);\n    return false;\n  }\n\n  // Ensure close button exists\n  ensureCloseButton(instance);\n\n  // Setup backdrop close behavior\n  setupBackdropClose(instance);\n\n  // Attach event listeners\n  attachEventListeners(instance);\n\n  return true;\n}\n\n/**\n * Cleans up event listeners\n * @param {Object} instance - Modal instance\n */\nfunction cleanup(instance) {\n  const { dialog, boundHandlers } = instance;\n\n  // Remove close button listeners\n  if (boundHandlers.closeButtons) {\n    boundHandlers.closeButtons.forEach(({ btn, handler }) => {\n      btn.removeEventListener('click', handler);\n    });\n  }\n\n  // Remove close event listener\n  if (boundHandlers.close) {\n    dialog.removeEventListener('close', boundHandlers.close);\n  }\n\n  // Remove backdrop click listener\n  if (boundHandlers.backdropClick) {\n    dialog.removeEventListener('click', boundHandlers.backdropClick);\n  }\n}\n\n/**\n * Modal class\n *\n * Built on native <dialog> element. Handles initialization, triggers,\n * close buttons, scroll lock, and URL integration.\n */\nexport class Modal {\n  constructor(dialog) {\n    this.id = generateUniqueId();\n    this.dialog = dialog;\n    this.value = normalizeValue(dialog.getAttribute(attributes.value));\n    this.config = parseConfig(dialog);\n\n    this.state = {\n      isOpen: false,\n    };\n\n    this.boundHandlers = {};\n\n    const initialized = init(this);\n    if (initialized) {\n      this.dialog._modal = this;\n    } else {\n      console.warn(`Modal ${this.id}: Initialization failed`);\n    }\n  }\n\n  /**\n   * Opens the modal\n   * @returns {Modal} The instance for chaining\n   */\n  open() {\n    const { dialog, state, config } = this;\n\n    // No-op if already open\n    if (state.isOpen) return this;\n\n    // Lock scroll\n    if (config.scrollLock) {\n      lock();\n    }\n\n    dialog.showModal();\n    state.isOpen = true;\n\n    // Update URL\n    updateUrl(this, 'open');\n\n    return this;\n  }\n\n  /**\n   * Closes the modal\n   * @returns {Modal} The instance for chaining\n   */\n  close() {\n    const { dialog, state } = this;\n\n    // close() triggers the 'close' event which handles cleanup\n    if (state.isOpen) {\n      dialog.close();\n    }\n\n    return this;\n  }\n\n  /**\n   * Re-initializes the modal after DOM changes\n   * Also discovers and initializes any new modals\n   * @returns {Modal} The instance for chaining\n   */\n  refresh() {\n    // Clean up current listeners\n    cleanup(this);\n\n    // Re-initialize\n    this.boundHandlers = {};\n    init(this);\n\n    return this;\n  }\n\n  /**\n   * Destroys the modal instance and cleans up\n   */\n  destroy() {\n    cleanup(this);\n\n    // Remove instance reference\n    delete this.dialog._modal;\n\n    // Clear all properties\n    this.dialog = null;\n    this.config = null;\n    this.state = null;\n    this.boundHandlers = null;\n  }\n}\n\n/**\n * Sets up global trigger listeners\n * Called once during auto-init\n */\nexport function setupTriggerListeners() {\n  // Use event delegation on document for all triggers\n  document.addEventListener('click', (e) => {\n    const trigger = e.target.closest(selectors.trigger);\n    if (!trigger) return;\n\n    e.preventDefault();\n\n    const targetValue = normalizeValue(\n      trigger.getAttribute(attributes.triggerValue)\n    );\n\n    // Setup aria-controls if not set\n    const targetDialog = findModalByValue(targetValue);\n    if (targetDialog) {\n      setupTriggerAria(trigger, targetDialog);\n    }\n\n    handleTriggerClick(trigger, targetValue);\n  });\n}\n\n/**\n * Opens modals based on URL parameters\n * Called during auto-init\n */\nexport function openFromUrl() {\n  const params = new URLSearchParams(window.location.search);\n\n  document.querySelectorAll(`[${attributes.urlParam}]`).forEach((dialog) => {\n    const paramName = dialog.getAttribute(attributes.urlParam);\n    if (params.has(paramName) && dialog._modal) {\n      dialog._modal.open();\n    }\n  });\n}\n\n// Export for use in modal.js\nexport { ensureDialog };\n","/**\n * Modal library entry point\n *\n * Auto-initializes all modal elements on DOMContentLoaded.\n * Built on native <dialog> element.\n *\n * @example\n * <!-- Trigger (anywhere in document) -->\n * <button data-modal-trigger-value=\"login\">Open Login</button>\n *\n * <!-- Modal -->\n * <dialog data-modal-value=\"login\">\n *   <button data-modal-close>Close</button>\n *   <h2>Login</h2>\n *   <form>...</form>\n * </dialog>\n */\n\nimport { selectors, attributes } from './config.js';\nimport { Modal, ensureDialog, setupTriggerListeners, openFromUrl } from './core.js';\n\n/**\n * Auto-initializes all modals on the page\n * Called on DOMContentLoaded or immediately if DOM is ready\n */\nfunction autoInit() {\n  // Find all modal elements\n  const modalElements = document.querySelectorAll(selectors.modal);\n\n  modalElements.forEach((element) => {\n    // Skip if already initialized\n    if (element._modal) return;\n\n    try {\n      // Wrap non-dialog elements in <dialog>\n      const dialog = ensureDialog(element);\n\n      // Create modal instance\n      new Modal(dialog);\n    } catch (error) {\n      console.warn('Modal auto-initialization failed:', error);\n    }\n  });\n\n  // Setup global trigger listeners (event delegation)\n  setupTriggerListeners();\n\n  // Check URL for deep-linked modals\n  openFromUrl();\n}\n\n// Execute on DOMContentLoaded or immediately if DOM is already ready\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', autoInit);\n} else {\n  autoInit();\n}\n\n// Export Modal class for module usage\nexport { Modal };\n"],"names":[],"mappings":"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"}