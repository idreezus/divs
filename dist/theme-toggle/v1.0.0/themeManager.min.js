/*!
 * Theme Toggle v1.0.0
 * A vanilla JavaScript theme switcher for light, dark, and custom themes.
 *
 * A part of Divs by Idreezus, a component library
 * divs.idreezus.com
 *
 * (c) 2025 Idrees Isse (https://github.com/idreezus)
 * Released under AGPL-3.0
 */
!function(){"use strict";(()=>{const e="data-theme-value",t="theme",s={themes:["light","dark"].slice(),current:null,theme:null,initialized:!1,_toggles:[],_toggleListeners:new WeakMap,_mediaQuery:null,_mediaQueryListener:null,getEffectiveTheme:e=>"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e,setTheme(e,s={}){const{force:i=!1}=s,n="system"===e,r=n?this.getEffectiveTheme("system"):e;if(!n&&-1===this.themes.indexOf(e))return console.warn(`[ThemeManager] Theme "${e}" not in themes array:`,this.themes),this;if(!i&&r===this.current&&e===this.theme)return this;const h=this.current,m=this.theme;this.current=r,this.theme=e,h&&document.documentElement.classList.remove(h),document.documentElement.classList.add(r),document.documentElement.setAttribute("data-theme",e);try{localStorage.setItem(t,e)}catch(e){console.warn("[ThemeManager] localStorage unavailable")}const a=h!==r;return(a||m!==e||i)&&window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:r,previous:h,userTheme:e,previousUserTheme:m,effectiveChanged:a}})),this},getTheme(){return this.current},getUserTheme(){return this.theme},getSource(){return"system"===this.theme?"system":"user"},toggleTheme(){const e=this.themes.filter(e=>"system"!==e),t=e.indexOf(this.current),s=-1===t?0:(t+1)%e.length;return this.setTheme(e[s])},_setupToggles(){document.querySelectorAll("[data-theme-toggle]").forEach(e=>{const t=()=>this.toggleTheme();e.addEventListener("click",t),this._toggles.push(e),this._toggleListeners.set(e,t)}),document.querySelectorAll(`[${e}]`).forEach(t=>{const s=t.getAttribute(e),i=()=>this.setTheme(s);t.addEventListener("click",i),this._toggles.push(t),this._toggleListeners.set(t,i)})},_teardownToggles(){this._toggles.forEach(e=>{const t=this._toggleListeners.get(e);t&&(e.removeEventListener("click",t),this._toggleListeners.delete(e))}),this._toggles=[]},init(){if(this.initialized)return console.warn("[ThemeManager] Already initialized. Call destroy() first."),this;try{let e=null;try{e=localStorage.getItem(t)}catch(e){}const s=e||"system";"system"!==s&&-1===this.themes.indexOf(s)?this.theme="system":this.theme=s,this.current=this.getEffectiveTheme(this.theme),this.setTheme(this.theme,{force:!0}),this._setupToggles(),this._setupSystemSync(),this.initialized=!0}catch(e){console.error("[ThemeManager] Initialization failed:",e)}return this},_setupSystemSync(){this._mediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this._mediaQueryListener=e=>{if("system"===this.theme){const t=e.matches?"dark":"light",s=this.current;this.current=t,document.documentElement.classList.remove(s),document.documentElement.classList.add(t),window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:t,previous:s,userTheme:"system",previousUserTheme:"system",effectiveChanged:!0}}))}},this._mediaQuery.addEventListener("change",this._mediaQueryListener)},_teardownSystemSync(){this._mediaQuery&&this._mediaQueryListener&&(this._mediaQuery.removeEventListener("change",this._mediaQueryListener),this._mediaQuery=null,this._mediaQueryListener=null)},refresh(){return this.initialized?(this._teardownToggles(),this._setupToggles(),this):(console.warn("[ThemeManager] Not initialized. Call init() first."),this)},destroy(){return this.initialized?(this._teardownToggles(),this._teardownSystemSync(),this.current=null,this.theme=null,this.initialized=!1,this):this}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{s.init()}):s.init(),"undefined"!=typeof window&&(window.ThemeManager=s)})()}();
//# sourceMappingURL=themeManager.min.js.map
