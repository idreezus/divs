/*!
 * Carousel v0.1.7
 * A lightweight, accessible carousel component built on CSS scroll snap
 * 
 * A part of Divs by Idreezus, a component library
 * divs.idreezus.com
 * 
 * (c) 2025 Idrees Isse (https://github.com/idreezus)
 * Released under AGPL-3.0
 */
!function(){"use strict";const t={CONTAINER:'[data-carousel="container"]',TRACK:'[data-carousel="track"]',ITEM:'[data-carousel="item"]',PREV_BTN:'[data-carousel="prev"]',NEXT_BTN:'[data-carousel="next"]',PAGINATION:'[data-carousel="pagination"]',DOT:'[data-carousel="dot"]'},e="start",n="item",r={SELECTORS:t,CLASSES:{SCROLLING:"carousel-scrolling",DISABLED:"carousel-button-disabled",ACTIVE:"carousel-item-active",ANIMATING:"carousel-animating",SNAP_DISABLED:"carousel-snap-disabled",PAGINATION_ACTIVE:"carousel-pagination-active"},TIMING:{DEBOUNCE_RESIZE:150,DEBOUNCE_SCROLL:100,BUTTON_COOLDOWN:100,SNAP_DISABLE_DURATION:50},TOLERANCE:{EDGE_DETECTION:1}};let s=0;function a(t,e){let n;return function(...r){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),t(...r)},e)}}function o(t,e,n={}){const{events:r,container:s}=t;if(r.has(e)){r.get(e).forEach(r=>{r.call(t,{type:e,target:t,...n})})}const a=new CustomEvent(`carousel:${e}`,{detail:{carousel:t,...n},bubbles:!0});s.dispatchEvent(a)}function i(t){const{track:e,items:n,state:r,config:s}=t,a=getComputedStyle(e),o=t=>{if(!t||"auto"===t)return{value:0,specified:!1};const e=parseFloat(t);return Number.isNaN(e)?{value:0,specified:!1}:{value:e,specified:!0}},i=parseFloat(a.gap||a.columnGap)||0,c=o(a.paddingInlineStart||a.paddingLeft),l=o(a.paddingInlineEnd||a.paddingRight),d=o(a.scrollPaddingInlineStart||a.scrollPaddingLeft),u=o(a.scrollPaddingInlineEnd||a.scrollPaddingRight),E=d.specified?d.value:c.value,h=u.specified?u.value:l.value,f=e.clientWidth,g=e.scrollWidth,I=e.getBoundingClientRect(),m=n.map((t,n)=>{const r=t.getBoundingClientRect(),s=getComputedStyle(t),a=parseFloat(s.scrollMarginInlineStart||s.scrollMarginLeft),o=parseFloat(s.scrollMarginInlineEnd||s.scrollMarginRight),i=Number.isNaN(a)?0:a,c=Number.isNaN(o)?0:o,l=r.left-I.left+e.scrollLeft,d=r.width;return{index:n,left:l,width:d,center:l+d/2,right:l+d,marginStart:i,marginEnd:c}});Object.assign(r,{gap:i,containerWidth:f,scrollWidth:g,itemPositions:m,startInset:E,endInset:h}),t.snapAlign=s.align}function c(t){const{track:e,state:n,snapAlign:r}=t,{itemPositions:s,currentIndex:a,startInset:i=0,endInset:c=0}=n,l=function(t,e,n,r,s={}){const{startInset:a=0,endInset:o=0}=s,i=function(t,e,n,r={}){const{startInset:s=0,endInset:a=0}=r;switch(n){case"center":return t+e/2+(s-a)/2;case"end":return t+e-a;default:return t+s}}(e,n,r,{startInset:a,endInset:o});let c=0,l=1/0;return t.forEach((t,e)=>{const n=function(t,e){const n=t.marginStart||0,r=t.marginEnd||0;switch(e){case"center":return t.center+(r-n)/2;case"end":return t.right+r;default:return t.left-n}}(t,r),s=Math.abs(n-i);s<l&&(l=s,c=e)}),c}(s,e.scrollLeft,n.containerWidth,r,{startInset:i,endInset:c});l!==a&&(n.currentIndex=l,g(t),o(t,"change",{index:l}))}function l(t){const{track:e,prevBtn:n,nextBtn:s,state:a}=t,{CLASSES:i,TOLERANCE:c}=r,l=e.scrollLeft,{scrollWidth:d,containerWidth:u}=a,E=d-u,h=l<=c.EDGE_DETECTION,f=l>=E-c.EDGE_DETECTION;n&&(n.classList.toggle(i.DISABLED,h),n.disabled=h,h&&!a.hasEmittedStart?(o(t,"reach-start"),a.hasEmittedStart=!0):h||(a.hasEmittedStart=!1)),s&&(s.classList.toggle(i.DISABLED,f),s.disabled=f,f&&!a.hasEmittedEnd?(o(t,"reach-end"),a.hasEmittedEnd=!0):f||(a.hasEmittedEnd=!1))}function d(t,e){const{track:n,items:s,state:a,snapAlign:o}=t,{CLASSES:i,TIMING:c}=r,l=s[e];l?(a.isAnimating=!0,n.classList.add(i.ANIMATING),n.classList.add(i.SNAP_DISABLED),l.scrollIntoView({behavior:"smooth",block:"nearest",inline:o}),setTimeout(()=>{n.classList.remove(i.SNAP_DISABLED)},c.SNAP_DISABLE_DURATION),setTimeout(()=>{a.isAnimating=!1,n.classList.remove(i.ANIMATING)},c.BUTTON_COOLDOWN)):console.warn(`Carousel ${t.id}: No item found at index ${e}`)}function u(t){const{state:e}=t;if(e.isAnimating)return;const n=function(t){const{state:e,items:n}=t,{currentIndex:r}=e;return Math.min(r+1,n.length-1)}(t);d(t,n)}function E(t){const{state:e}=t;if(e.isAnimating)return;const n=function(t){const{state:e}=t,{currentIndex:n}=e;return Math.max(n-1,0)}(t);d(t,n)}function h(t){const{pagination:e,items:n,id:s}=t;if(!e)return;t.boundDotHandlers&&t.boundDotHandlers.forEach(({dot:t,handler:e})=>{t.removeEventListener("click",e)});const a=function(t){return Array.isArray(t)?t.length:0}(n),o=t.dots?[...t.dots]:[];if(0===o.length)return void console.warn(`Carousel ${s}: At least one pagination dot is required inside the pagination container.`);const i=[];t.boundDotHandlers=[];const c=o.map(t=>(t=>{if(t.tagName&&"button"===t.tagName.toLowerCase())return t;const e=document.createElement("button");for([...t.attributes].forEach(t=>{e.setAttribute(t.name,t.value)});t.firstChild;)e.appendChild(t.firstChild);return t.replaceWith(e),e})(t)),l=c.length;for(;c.length<a;){const t=c[c.length%l].cloneNode(!0);e.appendChild(t),c.push(t)}if(c.length>a){c.splice(a).forEach(t=>{t.remove()})}c.forEach((e,n)=>{((e,n)=>{const{CLASSES:s}=r;e.setAttribute("data-carousel","dot"),e.setAttribute("type","button"),e.classList.remove(s.PAGINATION_ACTIVE);const a=()=>t.goTo(n);e.addEventListener("click",a),t.boundDotHandlers.push({dot:e,handler:a}),i.push(e)})(e,n)}),t.dots=i,f(t)}function f(t){const{dots:e,state:n}=t,{CLASSES:s}=r,{currentIndex:a}=n;e&&0!==e.length&&e.forEach((t,e)=>{const n=e===a;t.classList.toggle(s.PAGINATION_ACTIVE,n)})}function g(t){const{rafPending:e}=t;e||(t.rafPending=!0,requestAnimationFrame(()=>{!function(t){const{items:e,state:n}=t,{CLASSES:s}=r,{currentIndex:a}=n;e.forEach((t,e)=>{t.classList.toggle(s.ACTIVE,e===a)})}(t),l(t),f(t),t.rafPending=!1}))}function I(t){const{track:e,prevBtn:n,nextBtn:s,id:i}=t;t.boundHandlers={scroll:()=>function(t){const{track:e}=t,{CLASSES:n,TIMING:s}=r;e.classList.add(n.SCROLLING),o(t,"scroll",{scrollLeft:e.scrollLeft}),t.debouncedScrollHandler||(t.debouncedScrollHandler=a(()=>{c(t),l(t),e.classList.remove(n.SCROLLING)},s.DEBOUNCE_SCROLL)),t.debouncedScrollHandler()}(t),prev:()=>E(t),next:()=>u(t)},e.addEventListener("scroll",t.boundHandlers.scroll,{passive:!0}),n&&n.addEventListener("click",t.boundHandlers.prev),s&&s.addEventListener("click",t.boundHandlers.next)}function m(t){const e=function(t){const{container:e,id:n}=t,{SELECTORS:s}=r,a=e.querySelector(s.TRACK);if(!a)return console.warn(`Carousel ${n}: Track element not found. Expected element with data-carousel="track".`),!1;const o=[...e.querySelectorAll(s.ITEM)];if(0===o.length)return console.warn(`Carousel ${n}: No items found. Expected at least one element with data-carousel="item".`),!1;const i=e.querySelector(s.PREV_BTN),c=e.querySelector(s.NEXT_BTN),l=e.querySelector(s.PAGINATION);let d=[];return l&&(d=[...l.querySelectorAll(s.DOT)]),e.setAttribute("data-carousel-id",n),Object.assign(t,{track:a,items:o,prevBtn:i,nextBtn:c,pagination:l,dots:d}),!0}(t);return!!e&&(i(t),I(t),function(t){const{container:e,track:n}=t,{TIMING:s}=r,o=a(()=>{null!==e.offsetParent&&(i(t),c(t),l(t))},s.DEBOUNCE_RESIZE);t.debouncedResizeHandler=o;const d=new ResizeObserver(()=>{o()});d.observe(e),d.observe(n),t.resizeObserver=d}(t),h(t),t.config.keyboard&&function(t,e,n){const{container:r}=t;r.hasAttribute("tabindex")||r.setAttribute("tabindex","0");const s=s=>{if(r.contains(s.target))switch(s.key){case"ArrowLeft":s.preventDefault(),e(t);break;case"ArrowRight":s.preventDefault(),n(t);break;case"Home":s.preventDefault(),t.goTo(0);break;case"End":s.preventDefault(),t.goTo(t.items.length-1)}};t.boundHandlers.keyboard=s,r.addEventListener("keydown",s)}(t,E,u),g(t),!0)}class A{constructor(t){const r=(s+=1,`carousel-${s}`),a=function(t){return{align:t.getAttribute("data-carousel-align")||e,keyboard:"true"===t.getAttribute("data-carousel-keyboard"),scrollBy:t.getAttribute("data-carousel-scroll-by")||n,loop:"true"===t.getAttribute("data-carousel-loop")}}(t);Object.assign(this,{container:t,id:r,config:a,state:{currentIndex:0,isScrolling:!1,isAnimating:!1,itemPositions:[],gap:0,containerWidth:0,scrollWidth:0,startInset:0,endInset:0,hasEmittedStart:!1,hasEmittedEnd:!1},events:new Map,rafPending:!1,boundHandlers:null,debouncedScrollHandler:null});m(this)||console.warn(`Carousel ${r}: Initialization failed due to missing required elements.`)}next(){return u(this),this}prev(){return E(this),this}goTo(t){const{items:e}=this;return t<0||t>=e.length?(console.warn(`Carousel ${this.id}: Invalid index ${t}. Must be between 0 and ${e.length-1}.`),this):(d(this,t),this)}getActiveIndex(){return this.state.currentIndex}refresh(){return i(this),c(this),g(this),this}destroy(){return function(t){const{prevBtn:e,nextBtn:n,track:r,container:s}=t;t.boundHandlers&&(r.removeEventListener("scroll",t.boundHandlers.scroll),e&&e.removeEventListener("click",t.boundHandlers.prev),n&&n.removeEventListener("click",t.boundHandlers.next),t.boundHandlers.keyboard&&s.removeEventListener("keydown",t.boundHandlers.keyboard)),t.boundDotHandlers&&t.boundDotHandlers.forEach(({dot:t,handler:e})=>{t.removeEventListener("click",e)}),t.resizeObserver&&(t.resizeObserver.disconnect(),t.resizeObserver=null),Object.keys(t).forEach(e=>{t[e]=null})}(this),null}on(t,e){const{events:n}=this;return n.has(t)||n.set(t,[]),n.get(t).push(e),this}off(t,e){const{events:n}=this;if(!n.has(t))return this;const r=n.get(t),s=r.indexOf(e);return s>-1&&r.splice(s,1),this}static init(t){if("string"==typeof t&&(t=document.querySelector(t)),!t)throw new Error("Carousel.init(): Container element not found");return new A(t)}}const b=new Map;function S(){document.querySelectorAll(t.CONTAINER).forEach(t=>{try{const e=new A(t);e.id&&b.set(e.id,e)}catch(t){console.warn("Carousel auto-initialization failed:",t)}}),b.size}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",S):S(),"undefined"!=typeof window&&(window.Carousel=A,window.CarouselInstances=b)}();
//# sourceMappingURL=carousel.min.js.map
